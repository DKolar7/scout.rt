/*******************************************************************************
 * Copyright (c) 2014-2015 BSI Business Systems Integration AG.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *     BSI Business Systems Integration AG - initial API and implementation
 ******************************************************************************/
@outline-breadcrumb-node-padding-v: 12px;
@outline-title-margin-left: 12px;
@outline-title-margin-right: 12px;
@outline-title-margin-bottom: 12px;
@compact-outline-node-padding-h: 16px;
@compact-outline-node-padding-v: @outline-breadcrumb-node-padding-v;

.outline {

  &.in-background > .tree-data > .tree-node.selected {
    background-color: @outline-in-background-selection-background-color;
    color: @palette-white;
  }

  & > .tree-data  {
    & > .scrollbar {
      &.y-axis {
        margin-right: 6px;
      }

      & > .scrollbar-thumb {
        background-color: fade(@scrollbar-thumb-inverted-color, 30%);
      }

      & > .scrollbar-thumb-move,
      & > .scrollbar-thumb:hover {
        background-color: fade(@scrollbar-thumb-inverted-color, 60%);
      }
    }

    & > .key-box {
      top: 7px !important;
    }

    & > .tree-node,
    & > .animation-wrapper > .tree-node {
      cursor: pointer;
      border: 0;

      /* leave some space for the scrollbar */
      padding-right: 8px;
      /* set top/bottom padding for item */
      padding-top: 8px;
      padding-bottom: 8px;

      &.group {
        background-color: @outline-group-background-color;
      }

      &.selected {
        color: @outline-selection-color;
        background-color: @outline-selection-background-color;
        border: 0;
      }

      & > .text {
        font-size: @font-size-plus;
      }

      & > .menubar {
        border: 0;
        background-color: inherit;
      }

      & > .tree-node-control {
        /* adjust control position */
        margin-left: -@outline-node-control-size - 5px;
        margin-top: -3px;

        width: @outline-node-control-size;
        height: @outline-node-control-size;
        line-height: @outline-node-control-size;

        &::before {
          font-size: @outline-node-control-size;
          /* always use same color as the tree-node label */
          color: inherit;
        }

        &:hover::before {
          color: @highlight-color;
        }
      }
    }
  }
}

.outline-title {
  #scout.font-text-large();
  #scout.overflow-ellipsis-nowrap();
  margin: 0 @outline-title-margin-right @outline-title-margin-bottom @outline-title-margin-left;
  border-bottom: 1px solid @outline-title-border-color;

  & > .key-box {
    top: 19px;
  }

  & > .menubar {
    display: block;
    background-color: @navigation-background-color;
    width: auto;
    position: absolute;
    right: @outline-title-margin-right;
    top: @outline-title-margin-bottom + 2; /* + 2 necessary to have it aligned with the text*/
    border: none;
    color: @navigation-color;

    & > .menubox > .menu-item:not(.disabled) {
      color: @navigation-color;

      &:hover,
      &:active {
        color: @navigation-color;
      }

      &:focus,
      &:not(.menu-button):focus {
        color: @navigation-color;

        &::after {
          border-color: @navigation-color;
          #scout.glow(@navigation-color);
        }
      }
    }

    & > .menubox > .menu-item:not(.menu-textandicon):focus::after  {
      #scout.focus-border-inverted();
    }
  }
}

.outline-title-text {
  /* outline title height should be the same as main menubar and desktop header height (if there are no view buttons visible) */
  padding: 20px 2px 12px 6px;
  cursor: pointer;
  display: block;
  width: auto;
}

/* bread crumb style (different colors and bigger font and arrow than original breadcrumb style) */
.outline.tree.breadcrumb {

  & > .outline-title {
    text-align: center;
    margin: 0;
  }

  & > .tree-data {
    & > .tree-node,
    & > .animation-wrapper > .tree-node {
      border-bottom: 1px solid @outline-breadcrumb-border-color;

      /* !important is necessary here to override the element specific left-padding (calculated by Tree.js for level indentation). */
      padding: @outline-breadcrumb-node-padding-v 2px !important;

      &.ancestor-of-selected,
      &.child-of-selected,
      &.selected {
        background-color: @outline-group-background-color;
      }

      &:active {
        background-color: @navigation-background-color;
      }

      &.selected {
        background-color: @outline-selection-background-color;
        color: @outline-selection-color;
        cursor: default;
      }

      &.ancestor-of-selected::before {
        border-top-color: @outline-selection-background-color;
        border-width: 8px 13px 0 13px;
        bottom: -9px;
      }

      &.ancestor-of-selected::after {
        border-top-color: @outline-group-background-color;
        border-width: 8px 13px 0 13px;
        bottom: -8px;
      }

      &.selected::before {
        border-top-color: @outline-selection-background-color;
        border-width: 8px 13px 0 13px;
        bottom: -8px;
      }

      &.selected::after {
        border: 0;
      }
    }

    &.has-detail-content > .tree-node.selected,
    &.has-detail-content > .animation-wrapper > .tree-node.selected {
      & > .text {
        font-weight: bold;
      }
    }
  }

  &:focus > .tree-data,
  &.focused > .tree-data {
    & > .tree-node,
    & > .animation-wrapper > .tree-node {

      &.parent-of-selected {
        border-color: @outline-breadcrumb-border-color;
      }

      &.parent-of-selected::before {
        border: 0;
      }

      &.selected {
        border-color: @outline-breadcrumb-border-color;
      }

      &.selected::before {
        border-top-color: @outline-selection-background-color;
      }
    }
  }
}

.compact.outline.breadcrumb {
  & > .outline-title {
    text-align: left;

    & > .outline-title-text {
      padding-left: @compact-outline-node-padding-h;
    }
  }

  & > .tree-data {

    & > .tree-node  {
      text-align: left;
      padding: 0 !important;

      & > .text {
        display: inline-block;
        padding: @compact-outline-node-padding-v @compact-outline-node-padding-h;
      }

      & > .node-menubar {
        position: absolute;
        right: 0;
        top: 0;
        width: auto;
        padding: @compact-outline-node-padding-v - 3px @compact-outline-node-padding-h 0 0;
      }

      & > .detail-menubar {
        padding: 0 @compact-outline-node-padding-h @compact-outline-node-padding-v @compact-outline-node-padding-h;
      }

      & > .form > .root-group-box > .group-box-body {
        padding-left: @compact-outline-node-padding-h - @mandatory-indicator-width;
        padding-right: @compact-outline-node-padding-h;
      }
    }

    &.detail-content-visible > .tree-node > .menubar {
      padding-bottom: 0;
    }
  }
}
