/*******************************************************************************
 * Copyright (c) 2014-2015 BSI Business Systems Integration AG.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *     BSI Business Systems Integration AG - initial API and implementation
 ******************************************************************************/
@wizard-progress-height: 60px;
@wizard-progress-border-width: 1px;
@wizard-progress-content-h-padding: 15px;
@wizard-progress-separator-width: 10px;
@wizard-progress-separator-line-width: 1px;

@wizard-progress-step-background-color: @palette-gray-3;
@wizard-progress-step-foreground-color: @text-color;
@wizard-progress-step-separator-color: @palette-gray-5;
@wizard-progress-active-step-background-color: @item-selection-background-color;
@wizard-progress-active-step-foreground-color: @wizard-progress-step-foreground-color;
@wizard-progress-active-step-separator-color: @wizard-progress-step-separator-color;
@wizard-progress-disabled-step-background-color: @background-color;
@wizard-progress-disabled-step-foreground-color: @text-disabled-color;

.wizard-steps {
  overflow: hidden;
  margin-left: @mandatory-indicator-width;
  margin-right: 0;
  padding-bottom: @scrollbar-margin + (2 * @scrollbar-side-margin);

  /* If wizard progress field is in the root-group-box and there is a menubar, */
  /* disable the top-border (because the menubar already has a border) */
  .root-group-box > .menubar.main-menubar ~ .group-box-body > .wizard-progress-field > & {
    border-top-color: transparent;
    margin-top: -@wizard-progress-border-width;
    padding-top: 0;
  }

  /* If wizard progress field is in the root-group-box, use negative margins to */
  /* draw it up to the border of the form (like the main-menubar) */
  .root-group-box > .group-box-body > .wizard-progress-field > & {
    margin-left: -@root-group-box-padding-left;
    margin-right: -@root-group-box-padding-right;
    padding-top: @group-margin-top;

    & > .wizard-steps-body > .wizard-step.first > .wizard-step-content {
      padding-left: @root-group-box-padding-left + @mandatory-indicator-width;
    }
    & > .wizard-steps-body > .wizard-step.last > .wizard-step-content {
      padding-right: @root-group-box-padding-right;
    }
  }
}

.wizard-steps-body {
  height: @wizard-progress-height;
  overflow: hidden;
  white-space: nowrap; /* Allows the last wizard-step to be 100% without line break */
  border-top: @wizard-progress-border-width solid @border-color;
  border-bottom: @wizard-progress-border-width solid @border-color;
  /* This creates a new stacking context: */
  position: relative;
  z-index: 0;

  /* If wizard progress field is in the root-group-box and there is a menubar, */
  /* disable the top-border (because the menubar already has a border) */
  /*.root-group-box > .menubar.main-menubar ~ .group-box-body > .wizard-progress-field > .wizard-steps > & {
    border-top-color: transparent;
    margin-top: -@wizard-progress-border-width;
  }*/

  /* If wizard progress field is in the root-group-box, use negative margins to */
  /* draw it up to the border of the form (like the main-menubar) */
  /*.root-group-box > .group-box-body > .wizard-progress-field > .wizard-steps > & {
    margin-left: -@root-group-box-padding-left;
    margin-right: -@root-group-box-padding-right;
    border-left: 0;
    border-right: 0;

    & > .wizard-step.first > .wizard-step-content {
      padding-left: @root-group-box-padding-left + @mandatory-indicator-width;
    }
  }*/
}

.wizard-step {
  display: inline-block;
  height: @wizard-progress-height - (2 * @wizard-progress-border-width);
  line-height: @wizard-progress-height - (2 * @wizard-progress-border-width);
  position: relative;

  &:last-child {
    & > .wizard-step-content {
      max-width: none;
    }
  }

  /* Step types */
  color: @wizard-progress-step-foreground-color;
  background-color: @wizard-progress-step-background-color;
  &.disabled {
    color: @wizard-progress-disabled-step-foreground-color;
    background-color: @wizard-progress-disabled-step-background-color;

    & .wizard-step-separator::after {
      /* border-left-color must match background color of .wizard-step */
      border-left-color: @wizard-progress-disabled-step-background-color;
    }
  }
  &.active {
    color: @wizard-progress-active-step-foreground-color;
    background-color: @wizard-progress-active-step-background-color;

    & .wizard-step-separator::after {
      /* border-left-color must match background color of .wizard-step */
      border-left-color: @wizard-progress-active-step-background-color;
    }
    & .wizard-step-separator::before {
      border-left-color: @wizard-progress-active-step-separator-color;
    }
  }
  &.before-active {
    & .wizard-step-separator::before {
      border-left-color: @wizard-progress-active-step-separator-color;
    }
  }
  &.all-before-active {
  }
  &.all-after-active {
    color: @wizard-progress-disabled-step-foreground-color;
    background-color: @wizard-progress-disabled-step-background-color;

    & .wizard-step-separator::after {
      /* border-left-color must match background color of .wizard-step */
      border-left-color: @wizard-progress-disabled-step-background-color;
    }
  }

  /* Step content */
  & > .wizard-step-content {
    display: inline-block;
    max-width: 200px;
    line-height: normal;
    vertical-align: middle;
    margin-top: -2px; /* TODO BSH Why is this necessary? inline-block seems to add some implicit margins, which causes the block not to be vertically centered */
    min-height: 30px;

    /* Spacing */
    padding-left: @wizard-progress-separator-width + @wizard-progress-content-h-padding;
    padding-right: @wizard-progress-content-h-padding;

    & > .wizard-step-title {
      #scout.overflow-ellipsis-nowrap();
      font-weight: bold;
    }
    & > .wizard-step-sub-title {
      #scout.overflow-ellipsis-nowrap();
    }
  }
  &:first-child > .wizard-step-content {
    padding-left: @wizard-progress-content-h-padding;
  }

  /* Step separator */
  .wizard-step-separator {
    /* Arrow separators (::after is behind ::before) */
    &::after,
    &::before {
      content: '';
      display: inline-block;
      position: absolute;
      top: (@wizard-progress-height / 2) - @wizard-progress-border-width;
      left: 100%;
      height: 0;
      width: 0;
      margin-top: -((@wizard-progress-height / 2) + 4);
      border-top: ((@wizard-progress-height / 2) + 4) solid transparent;
      border-bottom: ((@wizard-progress-height / 2) + 4) solid transparent;
      border-left: @wizard-progress-separator-width solid transparent;
      z-index: 1; /* draw over next .wizard-step */
    }
    &::after {
      /* border-left-color must match background color of .wizard-step */
      border-left-color: @wizard-progress-step-background-color;
    }
    &::before {
      margin-left: @wizard-progress-separator-line-width;
      border-left-color: @wizard-progress-step-separator-color;
    }
  }


  /* Hover state */
  &.action-enabled:hover {
    cursor: pointer;

    & > .wizard-step-content > .wizard-step-title {
      text-decoration: underline;
    }
  }
}
