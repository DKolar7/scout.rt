<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright (c) 2014-2015 BSI Business Systems Integration AG. All rights
  reserved. This program and the accompanying materials are made available
  under the terms of the Eclipse Public License v1.0 which accompanies this
  distribution, and is available at http://www.eclipse.org/legal/epl-v10.html
  Contributors: BSI Business Systems Integration AG - initial API and implementation -->
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <parent>
    <groupId>org.eclipse.scout.rt</groupId>
    <artifactId>org.eclipse.scout.rt</artifactId>
    <version>6.0.0-SNAPSHOT</version>
    <relativePath>../org.eclipse.scout.rt/pom.xml</relativePath>
  </parent>

  <artifactId>org.eclipse.scout.rt.ui.html.test</artifactId>
  <packaging>jar</packaging>
  <name>${project.groupId}:${project.artifactId}</name>

  <properties>
    <scout.script.version>5.0.0</scout.script.version>
    <sonar.sources>src/main,pom.xml</sonar.sources>
    <sonar.tests>src/test</sonar.tests>
  </properties>

  <dependencies>
    <!-- Build Dependencies -->
    <dependency>
      <groupId>org.eclipse.scout.rt</groupId>
      <artifactId>org.eclipse.scout.rt.ui.html</artifactId>
    </dependency>

    <!-- Build Dependencies (Provided) -->
    <dependency>
      <groupId>javax.servlet</groupId>
      <artifactId>javax.servlet-api</artifactId>
      <scope>provided</scope>
    </dependency>

    <!-- Test Dependencies -->
    <dependency>
      <groupId>org.eclipse.scout.rt</groupId>
      <artifactId>org.eclipse.scout.rt.client.test</artifactId>
    </dependency>

    <dependency>
      <groupId>ch.qos.logback</groupId>
      <artifactId>logback-classic</artifactId>
      <scope>test</scope>
    </dependency>
  </dependencies>

  <build>
    <pluginManagement>
      <plugins>
        <!-- Ignore copy-dependencies in eclipse workspace, because they are
          unpacked -->
        <plugin>
          <groupId>org.eclipse.m2e</groupId>
          <artifactId>lifecycle-mapping</artifactId>
          <version>1.0.0</version>
          <configuration>
            <lifecycleMappingMetadata>
              <pluginExecutions>
                <pluginExecution>
                  <pluginExecutionFilter>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-dependency-plugin</artifactId>
                    <versionRange>[2.0,)</versionRange>
                    <goals>
                      <goal>unpack-dependencies</goal>
                    </goals>
                  </pluginExecutionFilter>
                  <action>
                    <ignore></ignore>
                  </action>
                </pluginExecution>
              </pluginExecutions>
            </lifecycleMappingMetadata>
          </configuration>
        </plugin>
      </plugins>
    </pluginManagement>

    <plugins>

      <plugin>
        <!-- Loads phantomjs executable, necessary for jasmine plugin -->
        <groupId>com.github.klieber</groupId>
        <artifactId>phantomjs-maven-plugin</artifactId>
        <executions>
          <execution>
            <goals>
              <goal>install</goal>
            </goals>
          </execution>
        </executions>
      </plugin>

      <!-- Prepare JS test dependencies with Jasmine -->
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-dependency-plugin</artifactId>
        <executions>
          <execution>
            <id>copy</id>
            <goals>
              <goal>unpack-dependencies</goal>
            </goals>
            <phase>generate-test-sources</phase>
            <configuration>
              <outputDirectory>${project.build.directory}/ext</outputDirectory>
              <overWriteReleases>false</overWriteReleases>
              <overWriteSnapshots>true</overWriteSnapshots>
              <includes>**/*.js, **/*.css, **/*.png, **/*.json</includes>
              <stripVersion>true</stripVersion>
              <includeArtifactIds>org.eclipse.scout.rt.ui.html</includeArtifactIds>
            </configuration>
          </execution>
        </executions>
      </plugin>

      <!-- JS testing with Jasmine -->
      <plugin>
        <groupId>com.github.searls</groupId>
        <artifactId>jasmine-maven-plugin</artifactId>
        <configuration>
          <additionalContexts>
            <additionalContext>
              <contextRoot>ext</contextRoot>
              <directory>${project.build.directory}/ext</directory>
            </additionalContext>
          </additionalContexts>
        </configuration>
        <executions>
          <execution>
            <goals>
              <goal>test</goal>
            </goals>
          </execution>
        </executions>
      </plugin>

    </plugins>
  </build>

  <profiles>
    <profile>
      <id>dev</id>
      <build>
        <!-- Jasmine testing in development mode: reverence js files in workspace -->
        <!-- JS testing with Jasmine -->
        <plugins>
          <plugin>
            <groupId>com.github.searls</groupId>
            <artifactId>jasmine-maven-plugin</artifactId>
            <configuration>
              <additionalContexts>
                <additionalContext>
                  <contextRoot>ext</contextRoot>
                  <directory>${project.basedir}/../org.eclipse.scout.rt.ui.html/src/main/resources/</directory>
                </additionalContext>
                <additionalContext>
                  <contextRoot>ext</contextRoot>
                  <directory>${project.basedir}/../org.eclipse.scout.rt.ui.html/src/main/js</directory>
                </additionalContext>
              </additionalContexts>
            </configuration>
            <executions>
              <execution>
                <goals>
                  <goal>test</goal>
                </goals>
              </execution>
            </executions>
          </plugin>
        </plugins>

      </build>
    </profile>
  </profiles>


  <!-- primarily for license header generation -->
  <inceptionYear>2014</inceptionYear>
</project>
